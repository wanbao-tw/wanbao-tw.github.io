---
import BaseLayout from '../layouts/BaseLayout.astro';
import HeroCarousel from '../components/HeroCarousel.astro';
import ArticleCard from '../components/ArticleCard.astro';
import { getCollection } from 'astro:content';

// å–å¾—æ‰€æœ‰æ–‡ç« ï¼ŒæŒ‰æ—¥æœŸæ’åº
const allArticles = await getCollection('articles', ({ data }) => !data.draft);
const sortedArticles = allArticles.sort((a, b) => 
  new Date(b.data.date).getTime() - new Date(a.data.date).getTime()
);

// è¼ªæ’­å…§å®¹ - å¯è‡ªè¡Œæ–°å¢/ä¿®æ”¹å»£å‘Šæ©«å¹…
const slides = [
  {
    title: 'ğŸ® ç©å ± WANBAO',
    description: 'å°ˆæ³¨éŠæˆ²æ”»ç•¥èˆ‡ VTuber è³‡è¨Šçš„ç¨ç«‹åª’é«”',
    bgClass: 'slide-default'
  },
  {
    title: 'ğŸ“– TFT æ”»ç•¥å°ˆå€',
    description: 'è¯ç›Ÿæˆ°æ£‹æœ€æ–°é™£å®¹èˆ‡ç‡Ÿé‹æŠ€å·§',
    link: '/guide',
    linkText: 'æŸ¥çœ‹æ”»ç•¥',
    bgClass: 'slide-guide'
  },
  {
    title: 'ğŸ¦Š VTuber å°ˆå€',
    description: 'å°ç£ VTuber æ–°èã€å°ˆè¨ªèˆ‡å‰µä½œè€…ä»‹ç´¹',
    link: '/vtuber',
    linkText: 'æ¢ç´¢æ›´å¤š',
    bgClass: 'slide-vtuber'
  },
  // å»£å‘Šæ©«å¹…ç¯„ä¾‹ï¼š
  // {
  //   title: 'ğŸ”¥ å»£å‘Šæ¨™é¡Œ',
  //   description: 'å»£å‘Šæè¿°æ–‡å­—',
  //   link: 'https://å»£å‘Šé€£çµ',
  //   linkText: 'äº†è§£æ›´å¤š',
  //   bgImage: '/images/ads/banner.jpg'
  // },
];
---

<BaseLayout title="é¦–é ">
  <HeroCarousel slides={slides} />

  <section>
    <h2 class="section-title">ğŸ“° æœ€æ–°æ–‡ç« </h2>
    
    {sortedArticles.length > 0 ? (
      <div class="articles-grid">
        {sortedArticles.slice(0, 6).map((article) => (
          <ArticleCard
            title={article.data.title}
            tag={article.data.tag}
            tagName={article.data.tagName}
            date={article.data.date}
            author={article.data.author}
            slug={article.slug}
            image={article.data.image}
          />
        ))}
      </div>
    ) : (
      <div class="empty-state">
        <div class="empty-state__icon">ğŸ“</div>
        <p>é‚„æ²’æœ‰æ–‡ç« ï¼Œå¿«ä¾†å¯«ç¬¬ä¸€ç¯‡å§ï¼</p>
        <p style="font-size: 0.9rem; margin-top: 0.5rem;">
          åœ¨ <code>src/content/articles/</code> æ–°å¢ .md æª”æ¡ˆ
        </p>
      </div>
    )}
  </section>

  <section>
    <h2 class="section-title">ğŸ¯ æ–‡ç« åˆ†é¡</h2>
    <div class="category-grid">
      <a href="/guide" class="category-card">
        <div class="category-card__icon">ğŸ“–</div>
        <h3>éŠæˆ²æ”»ç•¥</h3>
        <p>TFTã€åŸç¥ã€å„é¡éŠæˆ²æ”»ç•¥</p>
      </a>
      <a href="/vtuber" class="category-card">
        <div class="category-card__icon">ğŸ¦Š</div>
        <h3>VTuber å°ˆå€</h3>
        <p>VTuber æ–°èã€å°ˆè¨ªã€å·¥å•†åˆä½œ</p>
      </a>
      <a href="/news" class="category-card">
        <div class="category-card__icon">ğŸ“°</div>
        <h3>éŠæˆ²æ–°è</h3>
        <p>æœ€æ–°éŠæˆ²æƒ…å ±èˆ‡ç”¢æ¥­å‹•æ…‹</p>
      </a>
    </div>
  </section>
</BaseLayout>
