---
import { Image } from 'astro:assets';

interface Props {
  title: string;
  tag: string;
  tagName: string;
  date: string;
  time?: string;
  author?: string;
  slug: string;
  image?: any;  // å¯ä»¥æ˜¯ ImageMetadata æˆ– string
}

const { title, tag, tagName, date, time, author = 'ç©å ±ç·¨è¼¯éƒ¨', slug, image } = Astro.props;

// æ ¼å¼åŒ–æ—¥æœŸæ™‚é–“é¡¯ç¤º
function formatDateTime(dateStr: string, timeStr?: string): string {
  let displayDate = dateStr;
  let displayTime = timeStr;
  
  if (dateStr.includes('T')) {
    const [d, t] = dateStr.split('T');
    displayDate = d;
    displayTime = displayTime || t;
  } else if (dateStr.includes(' ') && dateStr.length > 10) {
    const [d, t] = dateStr.split(' ');
    displayDate = d;
    displayTime = displayTime || t;
  }
  
  if (displayTime) {
    return `${displayDate} ${displayTime}`;
  }
  return displayDate;
}

const displayDateTime = formatDateTime(date, time);
---

<article class="article-card">
  {image ? (
    <Image 
      src={image} 
      alt={title} 
      class="article-card__image" 
      loading="lazy"
      width={400}
      height={225}
    />
  ) : (
    <div class="article-card__image article-card__image--placeholder"></div>
  )}
  <div class="article-card__content">
    <span class={`article-card__tag tag-${tag}`}>{tagName}</span>
    <h3 class="article-card__title">
      <a href={`/articles/${slug}`}>{title}</a>
    </h3>
    <p class="article-card__meta">
      <span class="meta-date">ğŸ“… {displayDateTime}</span>
      <span class="meta-author">âœï¸ {author}</span>
    </p>
  </div>
</article>

<style>
  .article-card__meta {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem 1rem;
    font-size: 0.85rem;
    color: var(--color-text-light);
  }
  
  .meta-date, .meta-author {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
  }
  
  .article-card__image--placeholder {
    background: linear-gradient(135deg, #e0e0e0 0%, #f5f5f5 100%);
  }
</style>
